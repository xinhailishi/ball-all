var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(h,a){function n(t){try{o(s.next(t))}catch(e){a(e)}}function r(t){try{o(s["throw"](t))}catch(e){a(e)}}function o(t){t.done?h(t.value):new i(function(e){e(t.value)}).then(n,r)}o((s=s.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return s([t,e])}}function s(i){if(h)throw new TypeError("Generator is already executing.");for(;o;)try{if(h=1,a&&(n=a[2&i[0]?"return":i[0]?"throw":"next"])&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[0,n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(n=o.trys,!(n=n.length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(s){i=[6,s],a=0}finally{h=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var h,a,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.textField.width=this.stage.stageWidth,this.textField.height=this.stage.stageHeight},e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.textColor=16777200,this.textField.size=80,this.textField.width=500,this.textField.height=300,this.textField.textAlign=egret.HorizontalAlign.CENTER,this.textField.verticalAlign=egret.VerticalAlign.MIDDLE},e.prototype.onProgress=function(t,e){this.textField.text="加载中..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){var e=t.call(this)||this;return e.v1=20,e.v2=0,e.ang=0,e.ang2=0,e.c=.017453292,e._distance=new egret.Point,e._touchePoint=new egret.Point,e._isyaoed=!1,e._inArc=!1,e._moveEnd=!0,e._touchStatus=!1,e.shape1=new egret.Shape,e.shape2=new egret.Shape,e.shape3=new egret.Shape,e.line1=new egret.Shape,e.line2=new egret.Shape,e.line3=new egret.Shape,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.addToStage,e),e}return __extends(e,t),e.prototype.addToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.drawBase(),[4,platform.login()];case 2:return e.sent(),[4,platform.getUserInfo()];case 3:return t=e.sent(),console.log(t),[2]}})})},e.prototype.drawBase=function(){this.stage.frameRate=60;var t=new egret.Shape;this.addChild(t),t.graphics.beginFill(2263842,1),t.graphics.lineStyle(5,2263842),t.graphics.drawRect(0,0,this.stage.stageWidth+40,this.stage.stageHeight+50),t.graphics.endFill(),t.touchEnabled=!1,this.setChildIndex(t,this.numChildren-1);var e=this.shape1;this.addChild(e),e.graphics.beginFill(0,1),e.graphics.lineStyle(5,0),e.graphics.drawCircle(0,0,30),e.graphics.endFill(),e.x=this.stage.stageWidth/2-60,e.y=this.stage.stageHeight-60,e.touchEnabled=!0,this.shape1.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouseDown,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.mouseUp,this),this.setChildIndex(e,this.numChildren-1);var i=this.shape2;this.addChild(i),i.graphics.beginFill(16777200,1),i.graphics.lineStyle(5,16777200),i.graphics.drawCircle(0,0,30),i.graphics.endFill(),i.x=this.stage.stageWidth/2+60,i.y=this.stage.stageHeight-60,i.touchEnabled=!0,this.setChildIndex(i,this.numChildren-2);var s=this.shape3;this.addChild(s),s.graphics.beginFill(5597999,1),s.graphics.lineStyle(5,16777215),s.graphics.drawCircle(0,0,50),s.graphics.endFill(),s.x=this.stage.stageWidth/2-25,s.y=100,s.touchEnabled=!1,this.setChildIndex(s,this.numChildren-3);var h=this.line1;h.graphics.lineStyle(10,16711935),h.graphics.moveTo(0,0),h.graphics.lineTo(this.stage.stageWidth,0),h.graphics.endFill(),h.x=0,h.y=150,this.addChild(h),this.setChildIndex(h,this.numChildren-3),this.removeChild(this.line1);var a=this.line2;a.graphics.lineStyle(10,16776960),a.graphics.moveTo(0,0),a.graphics.lineTo(this.stage.stageWidth,0),a.graphics.endFill(),a.x=0,a.y=this.stage.stageHeight-110,this.addChild(a),this.setChildIndex(a,this.numChildren-3);var n=this.line3;n.graphics.lineStyle(5,16711935),n.graphics.moveTo(0,0),n.graphics.lineTo(140,0),n.graphics.endFill(),n.x=this.shape1.x,n.y=this.shape1.y,this.addChild(n),this.setChildIndex(n,this.numChildren-3),n.rotation=-90,this.removeChild(this.line3)},e.prototype.mouseUp=function(t){console.log("Mouse Up."),this._touchStatus&&(this.timer=new egret.Timer(60,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.v1=10+Math.floor(50*(1-this.shape1.scaleX)),this.timer.start(),this._moveEnd=!1,this.removeChild(this.line3)),this._touchStatus=!1,this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},e.prototype.timerFunc=function(t){this.ang>0?(this.shape1.y=this.shape1.y+this.v1*Math.sin(this.ang*this.c),this.shape1.x=this.shape1.x+this.v1*Math.cos(this.ang*this.c)):this.ang<0&&(this.shape1.y=this.shape1.y+this.v1*Math.sin(this.ang*this.c),this.shape1.x=this.shape1.x+this.v1*Math.cos(this.ang*this.c)),this.v1=this.v1-.5,this.v1<0&&(this.timer.stop(),this._moveEnd=!0,this.v1=0),this.shape1.y<36&&(this._moveEnd=!0,this.shape1.y=36,this.ang=-this.ang),this.shape1.x<36&&(this._moveEnd=!0,this.shape1.x=36,this.ang=180-this.ang),this.shape1.y>this.stage.stageHeight-36&&(this._moveEnd=!0,this.shape1.y=this.stage.stageHeight-36,this.ang=-this.ang),this.shape1.x>this.stage.stageWidth-36&&(this._moveEnd=!0,this.shape1.x=this.stage.stageWidth-36,this.ang=180-this.ang),Math.abs(this.shape1.x-this.shape3.x)<20&&Math.abs(this.shape1.y-this.shape3.y)<20&&!this._inArc&&(this.timer.stop(),this._moveEnd=!0,this.shape1.x=this.shape3.x,this.shape1.y=this.shape3.y,this.v1=0,this._inArc=!0,this.shape1.graphics.clear(),this._isyaoed?(this.shape1.graphics.lineStyle(5,6908265),this.shape1.graphics.beginFill(6908265,1),this.shape1.touchEnabled=!0):(this.shape1.graphics.lineStyle(5,16711680),this.shape1.graphics.beginFill(16711680,1)),this.shape1.graphics.drawCircle(0,0,30),this.shape1.graphics.endFill(),this._isyaoed=!this._isyaoed),(Math.abs(this.shape1.x-this.shape3.x)>20||Math.abs(this.shape1.y-this.shape3.y)>20)&&(this._inArc=!1);var e=(this.shape1.x-this.shape2.x)*(this.shape1.x-this.shape2.x)+(this.shape1.y-this.shape2.y)*(this.shape1.y-this.shape2.y)<=3600;e&&!this.v2&&(this.ang2=this.ang,this.ang=this.ang+180,this.v2=2*this.v1,this.timer2=new egret.Timer(40,0),this.timer2.addEventListener(egret.TimerEvent.TIMER,this.timerFunc2,this),this.timer2.start(),this.shape2.scaleX=.8,this.shape2.rotation=this.ang2,this._isyaoed),this.line3.x=this.shape1.x,this.line3.y=this.shape1.y},e.prototype.timerFunc3=function(t){this._touchStatus?(this.shape1.scaleX-=.01,this.shape1.rotation=this.ang,this.shape1.scaleX<.4&&(this.shape1.scaleX=.4)):(this.shape1.scaleX+=.05,this.shape1.rotation=this.ang,this.shape1.scaleX>1&&(this.shape1.scaleX=1,this.timer3.stop()))},e.prototype.timerFunc2=function(t){this.v2&&(this.shape2.y=this.shape2.y+this.v2*Math.sin(this.ang2*this.c),this.shape2.x=this.shape2.x+this.v2*Math.cos(this.ang2*this.c)),this.v2=this.v2-.8,this.shape2.scaleX<1&&(this.shape2.scaleX+=.1),this.v2<0&&(this.timer2.stop(),this.v2=0,this.shape2.scaleX=1),this.shape2.y<36&&(this.shape2.y=36,this.ang2=-this.ang2),this.shape2.x<36&&(this.shape2.x=36,this.ang2=180-this.ang2),this.shape2.y>this.stage.stageHeight-36&&(this.shape2.y=this.stage.stageHeight-36,this.ang2=-this.ang2),this.shape2.x>this.stage.stageWidth-36&&(this.shape2.x=this.stage.stageWidth-36,this.ang2=180-this.ang2)},e.prototype.mouseDown=function(t){this._moveEnd&&(console.log("Mouse Down."),this._touchStatus=!0,this._touchePoint.x=t.stageX,this._touchePoint.y=t.stageY,this.ang=this.getTouchAngle(this.shape1),this.line3.rotation=this.ang,this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this),this.addChild(this.line3),egret.setTimeout(function(){this.timer3=new egret.Timer(40,0),this.timer3.addEventListener(egret.TimerEvent.TIMER,this.timerFunc3,this),this.timer3.start()},this,500))},e.prototype.mouseMove=function(t){if(this._touchStatus){this._touchePoint.x=t.stageX,this._touchePoint.y=t.stageY;var e=this.ang=this.getTouchAngle(this.shape1);this.line3.rotation=e,console.info(e)}},e.prototype.getTouchAngle=function(t){var e=0;return e=Math.atan2(this._touchePoint.y-t.y,this._touchePoint.x-t.x)/this.c},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,s,h,a,n;return __generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return r.sent(),[4,RES.loadGroup("preload",0,t)];case 2:return r.sent(),e=this._sound1=new egret.Sound,this._sound1=RES.getRes("fashe_mp3"),i=this._sound2=new egret.Sound,this._sound2=RES.getRes("pengzhuang_mp3"),i.addEventListener(egret.Event.COMPLETE,function(t){},this),s=this._sound4=new egret.Sound,this._sound4=RES.getRes("win_mp3"),h=this._sound5=new egret.Sound,this._sound5=RES.getRes("jinquan_mp3"),a=this._sound3=new egret.Sound,a.load("resource/assets/background"+Math.floor(3*Math.random())+".mp3"),a.addEventListener(egret.Event.COMPLETE,function(t){},this),this.stage.removeChild(t),[3,4];case 3:return n=r.sent(),console.error(n),[3,4];case 4:return[2]}})})},e.prototype.createGameScene=function(){var t=this.createBitmapByName("bg_jpg");this.addChild(t);var e=this.stage.stageWidth,i=this.stage.stageHeight;t.width=e,t.height=i;var s=new egret.Shape;s.graphics.beginFill(0,.5),s.graphics.drawRect(0,0,e,172),s.graphics.endFill(),s.y=33,this.addChild(s);var h=this.createBitmapByName("egret_icon_png");this.addChild(h),h.x=26,h.y=33;var a=new egret.Shape;a.graphics.lineStyle(2,16777215),a.graphics.moveTo(0,0),a.graphics.lineTo(0,117),a.graphics.endFill(),a.x=172,a.y=61,this.addChild(a);var n=new egret.TextField;n.textColor=16777215,n.width=e-172,n.textAlign="center",n.text="Hello Egret",n.size=24,n.x=172,n.y=80,this.addChild(n);var r=new egret.TextField;this.addChild(r),r.alpha=0,r.width=e-172,r.textAlign=egret.HorizontalAlign.CENTER,r.size=24,r.textColor=16777215,r.x=172,r.y=135,this.textfield=r},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.startAnimation=function(t){var e=this,i=new egret.HtmlTextParser,s=t.map(function(t){return i.parse(t)}),h=this.textfield,a=-1,n=function(){a++,a>=s.length&&(a=0);var t=s[a];h.textFlow=t;var i=egret.Tween.get(h);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(n,e)};n()},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);